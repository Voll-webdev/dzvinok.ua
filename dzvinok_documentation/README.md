# Архітектура проекту dzvinok.ua

## Огляд проекту

dzvinok.ua - інтернет-магазин з повноцінною системою управління товарами, замовленнями та інтеграцією з 1С.

### Структура проекту

```
dzvinok.ua/
├── dzvinok_documentation/    # Документація, архітектура, контракти API
├── dzvinok_admin/           # Адміністративна панель (Laravel Filament)
└── dzvinok_main/            # Основний сайт (Laravel + Blade)
    ├── app/
    │   └── Models/          # Всі моделі Eloquent (централізовано)
    ├── database/
    │   └── migrations/      # Всі міграції БД
    └── src/                 # Модулі основного сайту
        ├── Catalog/         # Модуль каталогу товарів
        ├── Cart/            # Модуль кошика
        ├── Order/           # Модуль замовлень
        ├── Auth/            # Модуль авторизації
        ├── Profile/         # Модуль особистого кабінету
        ├── Search/          # Модуль пошуку
        ├── Api/             # Модуль API для 1С
        └── Common/          # Загальні компоненти
```

### Технології

- **PHP**: 8.2+
- **Laravel**: 11.x
- **MySQL**: 8.0+
- **Laravel Filament**: 3.x (адмін панель)
- **Frontend**: Blade Templates, Livewire 3.x, Alpine.js, Tailwind CSS
- **Інтеграція**: REST API для 1С

### Принципи архітектури

- Єдина база даних для dzvinok_admin та dzvinok_main
- Всі міграції створюються в dzvinok_main
- API для 1С розташоване в dzvinok_main
- Двостороння синхронізація даних з 1С
- Адмін панель використовує ресурси Filament для управління даними
- Модульна структура бекенду основного сайту:
  - Кожен функціональний розділ виділяється в окремий модуль в `dzvinok_main/src/`
  - Модулі містять контролери, сервіси, запити, шаблони та інші компоненти
  - Всі моделі Eloquent зберігаються централізовано в `app/Models/`
  - Забезпечує чітке розділення відповідальності та полегшує підтримку коду

---

## 1. База даних

### 1.1 Структура таблиць

- Users - користувачі системи
- Products - товари
- Categories - категорії товарів
- ProductCategories - зв'язок товарів і категорій (Many-to-Many)
- ProductImages - зображення товарів
- ProductAttributes - атрибути товарів (характеристики)
- Filters - фільтри
- FilterValues - значення фільтрів
- ProductFilters - зв'язок товарів і фільтрів
- Orders - замовлення
- OrderItems - позиції замовлення
- OrderStatuses - статуси замовлень
- Cart - кошик
- CartItems - товари в кошику
- Customers - клієнти
- Addresses - адреси доставки
- PaymentMethods - способи оплати
- DeliveryMethods - способи доставки
- SyncLogs - логи синхронізації з 1С

### 1.2 Міграції

Всі міграції створюються в `dzvinok_main/database/migrations/`

### 1.3 Seeders

Початкові дані для розробки та тестування

---

## 2. Основний сайт (dzvinok_main)

### Модульна структура

Основний сайт побудований за модульним принципом для забезпечення масштабованості та зручності підтримки.

#### Структура модуля

Кожен модуль в `dzvinok_main/src/` містить:
- `Controllers/` - контролери для обробки HTTP запитів
- `Services/` - бізнес-логіка та сервіси
- `Requests/` - класи валідації форм
- `Resources/` - ресурси для API відповідей (якщо потрібно)
- `Views/` - Blade шаблони модуля
- `routes.php` - маршрути модуля (опціонально)

#### Список модулів

- `Catalog` - каталог товарів, категорії, фільтрація
- `Cart` - кошик покупок
- `Order` - оформлення та управління замовленнями
- `Auth` - авторизація та реєстрація
- `Profile` - особистий кабінет користувача
- `Search` - пошук товарів
- `Api` - API endpoints для інтеграції з 1С
- `Common` - загальні компоненти (Header, Footer, меню тощо)

#### Моделі

Всі моделі Eloquent створюються в `dzvinok_main/app/Models/` та використовуються всіма модулями:
- Product, Category, Filter - для каталогу
- Cart, CartItem - для кошика
- Order, OrderItem - для замовлень
- User, Customer - для користувачів
- та інші згідно структури БД

### 2.1 Шапка сайту (Header)

#### 2.1.1 Логотип
- Посилання на головну сторінку

#### 2.1.2 Головне меню
- Каталог товарів (з випадаючим меню категорій)
- Меню статичних сторінок

#### 2.1.3 Пошук
- Пошукова форма з автодоповненням
- Пошук за назвою товару, артикулом, категорією

#### 2.1.4 Верхня панель
- Номер телефону
- Місто доставки

#### 2.1.5 Іконки дій
- Кошик (з кількістю товарів)
- Особистий кабінет
- Обране (wishlist)
- Порівння (compare)

### 2.2 Футер (Footer)

#### 2.2.1 Інформаційні блоки
- Про компанію
- Контактна інформація
- Робочі години

#### 2.2.2 Меню
- Доставка та оплата
- Гарантія та повернення
- Політика конфіденційності
- Публічна оферта

#### 2.2.3 Соціальні мережі
- Посилання на соціальні мережі
- Підписка на розсилку

#### 2.2.4 Копірайт
- Інформація про авторські права

### 2.3 Головна сторінка

#### 2.3.1 Головний слайдер
- Банери з акціями та новинками
- Адаптивний під різні пристрої

#### 2.3.2 Популярні категорії
- Блок з популярними категоріями товарів
- Зображення та назва категорії

#### 2.3.3 Популярні товари
- Вивід топ товарів
- Карточки товарів

#### 2.3.4 Акційні товари
- Товари зі знижками
- Таймер до кінця акції

#### 2.3.5 Новинки
- Нові надходження товарів

#### 2.3.6 Переваги
- Блок з перевагами магазину (швидка доставка, гарантія тощо)

### 2.4 Каталог товарів

#### 2.4.1 Список категорій
- Деревоподібна структура категорій
- Хлібні крихти (breadcrumbs)
- Кількість товарів у категорії

#### 2.4.2 Список товарів
- Відображення товарів у вигляді сітки/списку
- Пагінація
- Сортування (за популярністю, ціною, новизною, назвою)
- Кількість товарів на сторінці (вибір: 12, 24, 48)

#### 2.4.3 Фільтрація товарів
- Фільтри за категоріями
- Фільтри за ціною (діапазон)
- Фільтри за атрибутами (виробник, колір, розмір тощо)
- Фільтри за наявністю
- Активні фільтри (з можливістю видалення)
- Кнопка "Скинути фільтри"

#### 2.4.4 Карточка товару в списку
- Зображення товару
- Назва товару
- Артикул
- Ціна
- Акційна ціна
- Бейдж знижки (якщо є)
- Бейдж "Новинка" (якщо є)
- Бейдж "Хіт продажів"
- Наявність товару
- Кнопка "Додати в кошик"
- Кнопка "Додати в обране"
- Кнопка "Швидкий перегляд"

### 2.5 Сторінка товару

#### 2.5.1 Галерея зображень
- Основне зображення
- Мініатюри додаткових зображень
- Збільшене зображення у спливаючому вікні
- Слайдер зображень

#### 2.5.2 Основна інформація
- Назва товару
- Артикул
- Код товару
- Рейтинг та відгуки
- Наявність товару
- Ціна (стара ціна при знижці)
- Бейджі (знижка, новинка, хіт)

#### 2.5.3 Блок покупки
- Вибір кількості
- Кнопка "Додати в кошик"
- Кнопка "Купити в 1 клік"
- Кнопка "Додати в обране"

#### 2.5.4 Характеристики товару
- Таблиця з характеристиками
- Вкладки (Опис, Характеристики, Відгуки)

#### 2.5.5 Опис товару
- Детальний опис
- HTML форматування

#### 2.5.6 Відгуки
- Список відгуків
- Форма додавання відгуку
- Рейтинг товару

#### 2.5.7 Схожі товари
- Товари з тієї ж категорії
- Рекомендовані товари

### 2.6 Кошик

#### 2.6.1 Попап кошика
- Відкривається при додаванні товару
- Список доданих товарів (останні)
- Загальна сума
- Кнопка "Оформити замовлення"
- Кнопка "Продовжити покупки"


### 2.7 Оформлення замовлення

#### 2.7.1 Крок 1: Контактні дані
- Ім'я
- Прізвище
- Телефон
- Email
- Чекбокс "Створити аккаунт"

#### 2.7.2 Крок 2: Доставка
- Вибір способу доставки (Нова Пошта, Кур'єром Нової пошти, Самовивіз)
- Місто
- Відділення/Адреса
- Вибір магазину при самомвивозі
- Коментар до замовлення

#### 2.7.3 Крок 3: Оплата
- Вибір способу оплати (Готівкою, Безготівково, Оплата на сайті)

#### 2.7.4 Крок 4: Підтвердження
- Перегляд даних замовлення
- Згода з умовами
- Кнопка "Підтвердити замовлення"

#### 2.7.5 Сторінка подяки
- Номер замовлення
- Інформація про статус
- Кнопка "Продовжити покупки"

### 2.8 Пошук

#### 2.8.1 Сторінка результатів пошуку
- Запит пошуку
- Кількість знайдених товарів
- Список товарів (як у каталозі)
- Сортування результатів

#### 2.8.2 Автодоповнення
- Підказки при введенні
- Популярні запити
- Категорії товарів

### 2.9 Особистий кабінет

#### 2.9.1 Авторизація
- Форма входу (email, пароль)
- Відновлення пароля
- Реєстрація

#### 2.9.2 Реєстрація
- Ім'я, Прізвище
- Email
- Телефон
- Пароль
- Підтвердження пароля

#### 2.9.3 Мої замовлення
- Список всіх замовлень
- Статус замовлення
- Деталі замовлення
- Повторити замовлення

#### 2.9.4 Персональні дані
- Редагування профілю
- Зміна пароля

#### 2.9.5 Адреси доставки
- Список збережених адрес
- Додавання нової адреси
- Редагування адреси
- Видалення адреси

#### 2.9.6 Обране (Wishlist)
- Список обраних товарів
- Видалення з обраного
- Додавання в кошик

### 2.10 Статичні сторінки
- Про нас
- Оплата
- Доставка
- Повернення
- Контакти
- Обробка персональних даних
- Використання cookies
- Договір публічної оферти

---

## 3. Адміністративна панель (dzvinok_admin)

### 3.1 Дашборд
- Статистика продажів (графіки)
- Кількість замовлень за період
- Нові замовлення
- Статистика клієнтів

### 3.2 Управління товарами

#### 3.2.1 Список товарів
- Таблиця з товарами
- Фільтрація
- Пошук
- Масові дії (видалення, зміна статусу, категорії)

#### 3.2.2 Створення/Редагування товару
- Назва
- Артикул
- Опис
- Детальний опис
- Ціна
- Стара ціна
- Категорії (множинний вибір)
- Зображення (множинне завантаження)
- Характеристики
- Фільтри
- SEO (meta title, meta description)
- Наявність по магазинам
- Бейджі (новинка, хіт, акція)
- Статус (опублікований/чернетка)

### 3.3 Управління категоріями

#### 3.3.1 Список категорій
- Деревоподібна структура
- Сортування (drag & drop)
- Пошук

#### 3.3.2 Створення/Редагування категорії
- Назва
- Slug
- Батьківська категорія
- Зображення
- Опис
- SEO
- Порядок відображення
- Статус

### 3.4 Управління фільтрами

#### 3.4.1 Список фільтрів
- Таблиця з фільтрами
- Створення фільтру
- Генерація фільтрів в кеш

#### 3.4.2 Створення/Редагування фільтру
- Назва фільтру
- Тип фільтру (checkbox, radio, range, select)
- Значення фільтру
- Прив'язка до категорій
- Порядок відображення

### 3.5 Управління замовленнями

#### 3.5.1 Список замовлень
- Таблиця з замовленнями
- Фільтрація за статусом, датою, клієнтом
- Пошук за номером
- Експорт

#### 3.5.2 Деталі замовлення
- Інформація про клієнта
- Список товарів
- Сума замовлення
- Спосіб доставки
- Спосіб оплати
- Статус замовлення
- Історія змін статусу
- Коментарі продавця

#### 3.5.3 Статуси замовлень
- Статус замовлення приходить з 1С

### 3.6 Управління клієнтами

#### 3.6.1 Список клієнтів
- Таблиця з клієнтами
- Пошук
- Фільтрація

#### 3.6.2 Деталі клієнта
- Персональні дані
- Історія замовлень
- Адреси доставки
- Статистика покупок
- Бонусний рахунок

### 3.7 Контент менеджмент

#### 3.7.1 Банери
- Головна сторінка
- Категорії
- Створення/Редагування банера

#### 3.7.2 Статичні сторінки
- Список сторінок
- Редагування контенту
- SEO

#### 3.7.3 Меню
- Управління пунктами меню
- Порядок відображення

### 3.8 Маркетинг

#### 3.8.1 Промокоди
- Список промокодів
- Створення промокоду
- Тип знижки (відсоток, фіксована сума)
- Умови використання
- Термін дії

### 3.9 Налаштування

#### 3.9.1 Загальні налаштування
- Назва сайту
- Логотип
- Контактна інформація
- Робочі години
- Соціальні мережі

#### 3.9.2 Налаштування доставки
- Способи доставки
- Вартість доставки
- Інтеграція з API Нової Пошти

#### 3.9.3 Налаштування оплати
- Способи оплати
- Платіжні шлюзи

#### 3.9.4 Налаштування email
- Email відправника
- Налаштування emil адрес для нотифікацій адміністраторів чи продавців
- SMTP налаштування

#### 3.9.5 SEO налаштування
- Google Analytics
- Google Tag Manager
- Meta tags за замовчуванням

### 3.10 Користувачі та ролі

#### 3.10.1 Список користувачів
- Адміністратори
- Продавці
- Контент менеджер
- Створення користувача

#### 3.10.2 Ролі та дозволи
- Налаштування доступу
- Права на перегляд/редагування розділів

---

## 4. API для інтеграції з 1С

### 4.1 Аутентифікація
- Token-based authentication
- API ключі для 1С

### 4.2 Товари

#### 4.2.1 Отримання товарів
- GET `/api/1c/products` - список товарів
- GET `/api/1c/products/{id}` - деталі товару

#### 4.2.2 Створення/Оновлення товару
- POST `/api/1c/products` - створення товару
- PUT `/api/1c/products/{id}` - оновлення товару
- DELETE `/api/1c/products/{id}` - видалення товару

#### 4.2.3 Синхронізація залишків
- POST `/api/1c/products/stock` - оновлення залишків
- GET `/api/1c/products/stock` - отримання залишків

### 4.3 Категорії

#### 4.3.1 Отримання категорій
- GET `/api/1c/categories` - список категорій

#### 4.3.2 Створення/Оновлення категорії
- POST `/api/1c/categories` - створення категорії
- PUT `/api/1c/categories/{id}` - оновлення категорії

### 4.4 Замовлення

#### 4.4.1 Отримання замовлень
- GET `/api/1c/orders` - список нових замовлень
- GET `/api/1c/orders/{id}` - деталі замовлення

#### 4.4.2 Оновлення статусу замовлення
- PUT `/api/1c/orders/{id}/status` - зміна статусу

#### 4.4.3 Відправка замовлення в 1С
- POST `/api/1c/orders/{id}/confirm` - підтвердження від 1С

### 4.5 Ціни

#### 4.5.1 Оновлення цін
- POST `/api/1c/prices` - масове оновлення цін
- PUT `/api/1c/prices/{product_id}` - оновлення ціни товару

### 4.6 Клієнти

#### 4.6.1 Синхронізація клієнтів
- POST `/api/1c/customers` - створення/оновлення клієнта
- GET `/api/1c/customers` - отримання клієнтів

### 4.7 Логи синхронізації

#### 4.7.1 Запис логів
- Всі операції з API логуються
- Таблиця SyncLogs

#### 4.7.2 Перегляд логів
- Перегляд в адмін панелі
- Фільтрація за датою, типом операції, статусом

---

## 5. Розділення на спринти

---

## 6. Технічні вимоги

### 6.1 Продуктивність
- Оптимізація зображень (WebP)
- Кешування (Redis)
- Lazy loading для зображень

### 6.2 Безпека
- HTTPS
- CSRF захист
- XSS захист
- SQL Injection захист
- Валідація даних на сервері
- Rate limiting для API

### 6.3 SEO
- Семантична верстка
- Meta tags
- Open Graph
- Sitemap.xml
- Robots.txt
- Structured Data (Schema.org)

### 6.4 Адаптивність
- Mobile First підхід
- Responsive дизайн
- Підтримка всіх популярних браузерів

### 6.5 Доступність
- ARIA атрибути
- Keyboard navigation
- Screen reader friendly

---

## 7. Тестування

### 7.1 Unit тести
- Моделі
- Сервіси
- API endpoints

### 7.2 Feature тести
- Авторизація
- Додавання товару в кошик
- Оформлення замовлення
- API 1С

### 7.3 Browser тести
- Критичні user flows
- Оформлення замовлення
- Авторизація

---

## 8. Моніторинг та логування

### 8.1 Логування
- Системні логи (Laravel Log)
- Логи помилок
- Логи API запитів 1С
- Логи замовлень

### 8.2 Моніторинг
- Uptime моніторинг
- Продуктивність
- Помилки в real-time

---

Документація доповнюється.